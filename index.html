<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
	<title>JsTetris	- javascript tetris - open source</title>
	<meta http-equiv="Content-Type"	content="text/html;	charset=utf-8">
	<link href="tetris.css"	rel="stylesheet" type="text/css">
	<link href="tetris.ico" rel="shortcut icon">
	<script	type="text/javascript" src="tetris.js"></script>
	<style type="text/css">
	html, body { height: 100%; }
	#tetris	{ margin: 0	auto; }
	</style>
</head>
<body>

<table style="width: 100%; height: 100%;" cellspacing="0" cellpadding="0"><tr><td style="vertical-align: middle;">

	<div id="tetris">
		<div class="left">
			<h1><a href="https://github.com/cztomczak/jstetris">Js	Tetris 2.1</a></h1>
                        <div class="menu">
                                <div><a href="javascript:void(0)" id="tetris-menu-start">New Game</a></div>
                                <div><a href="javascript:void(0)" id="tetris-menu-classic">Modo Clásico</a></div>
                                <div id="tetris-pause">
                                        <a href="javascript:void(0)" id="tetris-menu-pause">Pause</a>
                                </div>
                                <div style="display: none;" id="tetris-resume">
                                        <a href="javascript:void(0)" id="tetris-menu-resume">Resume</a>
                                </div>
                                <div style="padding-top: 5px; padding-bottom: 5px; padding-left: 15px;">
                                        <input type="checkbox" id="tetris-coop-mode">
                                        <label for="tetris-coop-mode" style="font-size: 11px;">Modo Co-op (20x20)</label>
                                </div>
                                <div><a href="javascript:void(0)" id="tetris-menu-ai">IA Co-op: OFF</a></div>
                                <div style="padding-top: 5px; padding-bottom: 5px; padding-left: 15px;">
                                        <input type="checkbox" id="tetris-zen-mode">
                                        <label for="tetris-zen-mode" style="font-size: 11px;">Modo ZEN (1 celda/s)</label>
                                </div>
                                <div id="mode-indicator">Modo Clásico (12x22)</div>
                                <div class="bot-settings" style="margin-top: 6px;">
                                  <label style="color: #333; font-family: monospace; font-size: 11px;">
                                    <input type="checkbox" id="auto-mode-toggle" checked>
                                    Auto Mode IA
                                  </label>
                                </div>
                                <div><a href="javascript:void(0)" id="tetris-menu-highscores">Highscores</a></div>
                                <div><a href="javascript:void(0)" id="tetris-menu-help">About</a></div>
                        </div>
			<div id="tetris-nextpuzzle"></div>
			<div id="tetris-gameover">Game Over</div>
			<div id="tetris-keys">
				<div class="h5">Keyboard:</div>
				<table cellspacing="0" cellpadding="0">
				<tr>
					<td>Rotate:</td>
					<td></td>
					<td><img src="key-up.gif" width="14" height="14" alt=""></td>
					<td></td>
				</tr>
				<tr>
					<td>Move:</td>
					<td><img src="key-left.gif" width="14" height="14" alt=""></td>
					<td><img src="key-down.gif" width="14" height="14" alt=""></td>
					<td><img src="key-right.gif" width="14" height="14" alt=""></td>
				</tr>
				<tr>
					<td>Fall:</td>
					<td colspan="3">
						<img src="key-space.gif" width="44" height="13" alt="">
					</td>
				</tr>
				</table>
			</div>
			<div class="stats">
				<div class="h5">Statistics:</div>
				<table cellspacing="0" cellpadding="0">
				<tr>
					<td	class="level">Level:</td>
					<td><span id="tetris-stats-level">1</span></td>
				</tr>
				<tr>
					<td	class="score">Score:</td>
					<td><span id="tetris-stats-score">0</span></td>
				</tr>
				<tr>
					<td	class="lines">Lines:</td>
					<td><span id="tetris-stats-lines">0</span></td>
				</tr>
				<tr>
					<td	class="apm">APM:</td>
					<td><span id="tetris-stats-apm">0</span></td>
				</tr>
				<tr>
					<td	class="time">Time:</td>
					<td><span id="tetris-stats-time">0</span></td>
				</tr>

				</table>
			</div>
		</div>
		<div class="left-border"></div>
		<div id="tetris-area">
                        <div class="grid1"></div>
                        <div class="grid2"></div>
                        <div class="grid3"></div>
                        <div class="grid4"></div>
                        <div class="grid5"></div>
                        <div class="grid6"></div>
                        <div class="grid7"></div>
                        <div class="grid8"></div>
                        <div class="grid9"></div>
                        <div class="grid10"></div>
                </div>
		<div id="tetris-help" class="window">
			<div class="top">
				About <span id="tetris-help-close" class="close">x</span>
			</div>
			<div class="content" style="margin-top:	1em;">
				<div style="margin-top:	1em;">
				<div>JsTetris is a highly customizable tetris game written in javascript,
				full sources available, it is free to modify.
				</div>
				<br>
				<div>Author: Czarek Tomczak</div>
				<div>Site: <a href="https://github.com/cztomczak/jstetris">github.com/cztomczak/jstetris</a></div>
				<br>
				<div>License: BSD revised (free for any use)</div>
				</div>
			</div>
		</div>
		<div id="tetris-highscores"	class="window">
			<div class="top">
				Highscores <span id="tetris-highscores-close" class="close">x</span>
			</div>
			<div class="content">
				<div id="tetris-highscores-content"></div>
				<br>
				Note: these	scores are kept	in cookies,	they are only visible to your computer.
			</div>
		</div>
	</div>

</td></tr></table>

	<script	type="text/javascript">
        var tetris = new Tetris();
        tetris.unit = 14;
        tetris.setGameMode(false);

                // 1. Inicializar Bot (fallar rápido si no está disponible)
                var bot = null;
                if (typeof TetrisBot === "function") {
                        bot = new TetrisBot(tetris);
                        window.bot = bot;
                        tetris.updateBotToggleLabel();
                } else {
                        console.error("TetrisBot no está definido; el modo IA no se inicializó.");
                }

                var btnClassic = document.getElementById("tetris-menu-classic");
                if (btnClassic) {
                        btnClassic.onclick = function() {
                                tetris.setGameMode(false);

                                // UX: cambiar a modo clásico e iniciar la partida en un solo paso
                                tetris.start();

                                this.blur();
                        };
                }

                var coopCheckbox = document.getElementById("tetris-coop-mode");
                if (coopCheckbox) {
                        coopCheckbox.onchange = function()
                        {
                                tetris.setGameMode(this.checked);

                                // Fast fail: arrancar el juego solo cuando se habilita el modo cooperativo
                                if (this.checked) {
                                    tetris.start();
                                }
                        };
                }

                var aiToggleBtn = document.getElementById("tetris-menu-ai");
                if (aiToggleBtn) {
                        aiToggleBtn.onclick = function()
                        {
                                if (!window.bot || !window.bot.toggle) {
                                        console.warn("[BOT] Toggle no disponible; instanciación fallida.");
                                        return;
                                }

                                window.bot.toggle();
                                tetris.updateBotToggleLabel();
                                this.blur();
                        };
                }

                // 2. Selector de modo de juego vía teclado (fallar rápido si no hay bot)
                document.addEventListener("keydown", function(event) {
                        if (!bot || !bot.setGameplayMode) { return; }

                        // Mapear únicamente los modos heurísticos (modo BALANCED y ZEN quedan fuera del selector rápido)
                        var modeMap = {
                                "1": bot.GamePlayMode.SURVIVAL,
                                "2": bot.GamePlayMode.TETRIS_BUILDER,
                                "3": bot.GamePlayMode.PRO_ATTACK
                        };

                        var requestedMode = modeMap[event.key];
                        if (requestedMode) {
                                bot.setGameplayMode(requestedMode);
                        }
                });

        </script>

</body>
</html>














